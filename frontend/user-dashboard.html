<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Padel Tournament - User Dashboard</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #555; }
  </style>
</head>

<body class="bg-gray-50">

  <!-- Top Navigation Bar -->
  <nav class="bg-green-600 text-white shadow-lg">
    <div class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-4">
          <i class="fas fa-trophy text-2xl"></i>
          <div>
            <h1 class="text-2xl font-bold">Padel Tournament</h1>
            <p class="text-xs opacity-90">User Dashboard</p>
          </div>
        </div>

        <div class="flex items-center space-x-4">
          <div class="text-right">
            <div id="userEmail" class="text-sm">user@padel.com</div>
            <div class="text-xs opacity-90">Regular User</div>
          </div>
          <button onclick="logout()" class="bg-green-700 hover:bg-green-800 px-4 py-2 rounded-lg transition">
            <i class="fas fa-sign-out-alt mr-2"></i>Logout
          </button>
        </div>
      </div>
    </div>
  </nav>

  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-lg">
      <nav class="mt-8">
        <a href="#tournaments" onclick="loadPage('tournaments', event)"
           class="nav-link flex items-center px-6 py-3 text-gray-700 hover:bg-green-50 hover:text-green-700 transition">
          <i class="fas fa-trophy w-6"></i>
          <span class="ml-3">Tournaments</span>
        </a>

        <a href="#matches" onclick="loadPage('matches', event)"
           class="nav-link flex items-center px-6 py-3 text-gray-700 hover:bg-green-50 hover:text-green-700 transition">
          <i class="fas fa-table-tennis w-6"></i>
          <span class="ml-3">Matches</span>
        </a>

        <a href="#players" onclick="loadPage('players', event)"
           class="nav-link flex items-center px-6 py-3 text-gray-700 hover:bg-green-50 hover:text-green-700 transition">
          <i class="fas fa-users w-6"></i>
          <span class="ml-3">Players</span>
        </a>

        <a href="#teams" onclick="loadPage('teams', event)"
           class="nav-link flex items-center px-6 py-3 text-gray-700 hover:bg-green-50 hover:text-green-700 transition">
          <i class="fas fa-user-friends w-6"></i>
          <span class="ml-3">Teams</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8">
      <div id="mainContent">
        <div class="text-center py-20">
          <i class="fas fa-trophy text-6xl text-green-200 mb-4"></i>
          <h2 class="text-3xl font-bold text-gray-700 mb-2">Welcome!</h2>
          <p class="text-gray-500">Select a section from the sidebar.</p>
        </div>
      </div>
    </main>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-8 flex flex-col items-center">
      <i class="fas fa-spinner fa-spin text-4xl text-green-600 mb-4"></i>
      <p class="text-gray-700">Loading...</p>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="hidden fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-opacity">
    <div class="flex items-center">
      <i class="fas fa-check-circle mr-2"></i>
      <span id="toastMessage">Success!</span>
    </div>
  </div>

  <!-- ✅ Shared config FIRST -->
  <script src="dashboard/js/config.js"></script>

  <!-- ✅ Load USER page JS (correct paths) -->
  <script src="dashboard/js/user-tournaments.js"></script>
  <script src="dashboard/js/user-matches.js"></script>
  <script src="dashboard/js/user-players.js"></script>
  <script src="dashboard/js/user-teams.js"></script>

  <!-- Controller -->
  <script>
    function setActiveLink(event) {
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('bg-green-50', 'text-green-700', 'border-r-4', 'border-green-600');
      });
      if (event && event.target) {
        event.target.closest('.nav-link')
          .classList.add('bg-green-50', 'text-green-700', 'border-r-4', 'border-green-600');
      }
    }

    function loadPage(page, event) {
      setActiveLink(event);

      switch (page) {
        case "tournaments":
          if (typeof loadTournamentsPage === "function") return loadTournamentsPage();
          break;
        case "matches":
          if (typeof loadMatchesPage === "function") return loadMatchesPage();
          break;
        case "players":
          if (typeof loadPlayersPage === "function") return loadPlayersPage();
          break;
        case "teams":
          if (typeof loadTeamsPage === "function") return loadTeamsPage();
          break;
      }

      console.error("Page function not found. Check that user JS files are loading correctly.");
    }

    // Optional auth check (enable later)
    function checkAuth() {
      if (!getToken()) window.location.href = "/login";
    }

    window.onload = function () {
      // checkAuth();

      // Default route: tournaments
      loadPage("tournaments");
    };
  </script>

</body>
</html>
